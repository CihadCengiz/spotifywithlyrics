{"version":3,"sources":["Login.js","Constants.js","TrackSearchResult.js","Player.js","Dashboard.js","useAuth.js","App.js","index.js"],"names":["Login","Container","className","style","minHeight","href","BASE_API_URL","TrackSearchResult","track","chooseTrack","cursor","onClick","src","albumUrl","height","width","title","artist","Player","accessToken","trackUri","useState","play","setPlay","useEffect","token","showSaveIcon","callback","state","isPlaying","uris","spotifyApi","SpotifyWebApi","clientId","Dashboard","code","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","axios","post","then","res","data","window","history","pushState","catch","location","interval","setInterval","clearInterval","useAuth","search","setSearch","searchResults","setSearchResults","playingTrack","setPlayingTrack","lyrics","setLyrics","get","params","cancel","searchTracks","body","tracks","items","map","smallestAlbumImage","album","images","reduce","smallest","image","artists","name","uri","url","Form","Control","type","placeholder","value","onChange","e","target","overflowY","length","whiteSpace","URLSearchParams","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"sKAKe,SAASA,IACpB,OACI,cAACC,EAAA,EAAD,CAAWC,UAAU,mDAAmDC,MAAO,CAACC,UAAW,SAA3F,SACI,mBAAGF,UAAU,yBAAyBG,KALjC,oTAKL,kC,oCCRCC,EAAe,0CCEb,SAASC,EAAT,GAAkD,IAAtBC,EAAqB,EAArBA,MAAOC,EAAc,EAAdA,YAI9C,OACI,sBAAKP,UAAU,gCACfC,MAAO,CAACO,OAAQ,WAChBC,QANJ,WACIF,EAAYD,IAGZ,UAGI,qBAAKI,IAAKJ,EAAMK,SAAUV,MAAO,CAACW,OAAQ,OAAQC,MAAO,UACzD,sBAAKb,UAAU,OAAf,UACI,8BAAMM,EAAMQ,QACZ,qBAAKd,UAAU,aAAf,SAA6BM,EAAMS,e,YCVpC,SAASC,EAAT,GAA0C,IAAzBC,EAAwB,EAAxBA,YAAaC,EAAW,EAAXA,SACzC,EAAwBC,oBAAS,GAAjC,mBAAOC,EAAP,KAAaC,EAAb,KAKA,OAHAC,qBAAU,kBAAMD,GAAQ,KAAO,CAACH,IAG5BD,EAEJ,cAAC,IAAD,CACIM,MAAON,EACPO,cAAY,EACZC,SAAU,SAAAC,GACFA,EAAMC,WAAWN,GAAQ,IAEjCD,KAAMA,EACNQ,KAAMV,EAAW,CAACA,GAAW,KATT,K,YCAtBW,EAAa,I,OAAIC,GAAc,CACjCC,SAAU,qCAGC,SAASC,EAAT,GAA8B,IACnCf,ECVK,SAAiBgB,GAC5B,MAAsCd,qBAAtC,mBAAOF,EAAP,KAAoBiB,EAApB,KACA,EAAwCf,qBAAxC,mBAAOgB,EAAP,KAAqBC,EAArB,KACA,EAAkCjB,qBAAlC,mBAAOkB,EAAP,KAAkBC,EAAlB,KA+BA,OA7BAhB,qBAAU,WACNiB,IAAMC,KAAN,UAAcpC,EAAd,UAAoC,CAChC6B,SACDQ,MAAK,SAAAC,GACJR,EAAeQ,EAAIC,KAAK1B,aACxBmB,EAAgBM,EAAIC,KAAKR,cACzBG,EAAaI,EAAIC,KAAKN,WACtBO,OAAOC,QAAQC,UAAU,GAAI,KAAM,QACpCC,OAAM,WACLH,OAAOI,SAAW,SAEvB,CAACf,IAEJX,qBAAU,WACN,GAAIa,GAAiBE,EAArB,CACA,IAAMY,EAAWC,aAAY,WACzBX,IAAMC,KAAN,UAAcpC,EAAd,YAAsC,CAClC+B,iBACDM,MAAK,SAAAC,GACJR,EAAeQ,EAAIC,KAAK1B,aACxBqB,EAAaI,EAAIC,KAAKN,cACvBU,OAAM,WACLH,OAAOI,SAAW,SAEJ,KAAlBX,EAAY,KAEhB,OAAO,kBAAMc,cAAcF,OAC5B,CAACd,EAAcE,IAEXpB,EDxBamC,CADoB,EAARnB,MAEhC,EAA4Bd,mBAAS,IAArC,mBAAOkC,EAAP,KAAeC,EAAf,KACA,EAA0CnC,mBAAS,IAAnD,mBAAOoC,EAAP,KAAsBC,EAAtB,KACA,EAAwCrC,qBAAxC,mBAAOsC,EAAP,KAAqBC,EAArB,KACA,EAA4BvC,mBAAS,IAArC,mBAAOwC,EAAP,KAAeC,EAAf,KAEA,SAASrD,EAAYD,GACjBoD,EAAgBpD,GAChBgD,EAAU,IACVM,EAAU,IAgDd,OA7CAtC,qBAAU,WACFmC,GAEJlB,IAAMsB,IAAN,UAAazD,EAAb,WAAoC,CAChC0D,OAAQ,CACJxD,MAAOmD,EAAa3C,MACpBC,OAAQ0C,EAAa1C,UAE1B0B,MAAK,SAAAC,GACJkB,EAAUlB,EAAIC,KAAKgB,aAExB,CAACF,IAEJnC,qBAAU,WACFL,GACJY,EAAWK,eAAejB,KAC3B,CAACA,IAEJK,qBAAU,WACN,IAAI+B,EAAQ,OAAOG,EAAiB,IACpC,GAAIvC,EAAJ,CAEA,IAAI8C,GAAS,EAoBb,OAnBAlC,EAAWmC,aAAaX,GAAQZ,MAAK,SAAAC,GAC9BqB,GACHP,EAAiBd,EAAIuB,KAAKC,OAAOC,MAAMC,KAAI,SAAA9D,GACvC,IAAM+D,EAAqB/D,EAAMgE,MAAMC,OAAOC,QAC1C,SAACC,EAAUC,GACP,OAAGA,EAAM9D,OAAS6D,EAAS7D,OAAe8D,EACnCD,IAEXnE,EAAMgE,MAAMC,OAAO,IAEvB,MAAO,CACHxD,OAAQT,EAAMqE,QAAQ,GAAGC,KACzB9D,MAAOR,EAAMsE,KACbC,IAAKvE,EAAMuE,IACXlE,SAAU0D,EAAmBS,YAKlC,kBAAMf,GAAS,MACvB,CAACV,EAAQpC,IAGR,eAAClB,EAAA,EAAD,CAAWC,UAAU,0BAA0BC,MAAO,CAACW,OAAQ,SAA/D,UACI,cAACmE,EAAA,EAAKC,QAAN,CAAcC,KAAK,SAASC,YAAY,uBAAuBC,MAAO9B,EAAQ+B,SAAU,SAAAC,GAAC,OAAI/B,EAAU+B,EAAEC,OAAOH,UAChH,sBAAKnF,UAAU,mBAAmBC,MAAO,CAACsF,UAAU,QAApD,UACKhC,EAAca,KAAI,SAAA9D,GAAK,OACxB,cAACD,EAAD,CAAmBC,MAAOA,EAAuBC,YAAaA,GAAxBD,EAAMuE,QAEtB,IAAzBtB,EAAciC,QACX,qBAAKxF,UAAU,cAAcC,MAAO,CAACwF,WAAY,OAAjD,SACK9B,OAIT,8BACI,cAAC3C,EAAD,CAAQC,YAAaA,EAAaC,SAAQ,OAAEuC,QAAF,IAAEA,OAAF,EAAEA,EAAcoB,WEjF1E,IAAM5C,EAAO,IAAIyD,gBAAgB9C,OAAOI,SAASK,QAAQQ,IAAI,QAO9C8B,MAJf,WACE,OAAO1D,EAAO,cAACD,EAAD,CAAWC,KAAMA,IAAW,cAACnC,EAAD,KCJ5C8F,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,U","file":"static/js/main.ad94690a.chunk.js","sourcesContent":["import React from 'react'\r\nimport { Container } from 'react-bootstrap'\r\n\r\nconst AUTH_URL = \"https://accounts.spotify.com/authorize?client_id=be9b18b908064fafa6daf43e1a490689&response_type=code&redirect_uri=https://spotifywithlyrics.herokuapp.com&scope=streaming%20user-read-email%20user-read-private%20user-library-read%20user-library-modify%20user-read-playback-state%20user-modify-playback-state\"\r\n\r\nexport default function Login() {\r\n    return (\r\n        <Container className=\"d-flex justify-content-center align-items-center\" style={{minHeight: \"100vh\"}}>\r\n            <a className=\"btn btn-success btn-lg\" href={AUTH_URL}>\r\n                Login With Spotify\r\n            </a>\r\n        </Container>\r\n    )\r\n}\r\n","export const BASE_API_URL = 'https://spotifywithlyrics.herokuapp.com';","import React from 'react'\r\n\r\nexport default function TrackSearchResult({track, chooseTrack}) {\r\n    function handlePlay() {\r\n        chooseTrack(track)\r\n    }\r\n    return (\r\n        <div className=\"d-flex m-2 align-items-center\" \r\n        style={{cursor: \"pointer\"}}\r\n        onClick={handlePlay}>\r\n            <img src={track.albumUrl} style={{height: '64px', width: '64px'}} />\r\n            <div className=\"ms-3\">\r\n                <div>{track.title}</div>\r\n                <div className=\"text-muted\">{track.artist}</div>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import {useState, useEffect} from 'react'\r\nimport SpotifyPlayer from \"react-spotify-web-playback\"\r\n\r\nexport default function Player({accessToken, trackUri}) {\r\n    const [play, setPlay] = useState(false)\r\n\r\n    useEffect(() => setPlay(true), [trackUri])\r\n\r\n\r\n    if(!accessToken) return null\r\n    return (\r\n    <SpotifyPlayer \r\n        token={accessToken}\r\n        showSaveIcon\r\n        callback={state => {\r\n            if(!state.isPlaying) setPlay(false)\r\n        }}\r\n        play={play}\r\n        uris={trackUri ? [trackUri]: []}\r\n        />\r\n    )\r\n}\r\n","import {useState, useEffect} from 'react'\r\nimport { Container, Form } from 'react-bootstrap'\r\nimport useAuth from './useAuth'\r\nimport TrackSearchResult from './TrackSearchResult'\r\nimport Player from './Player'\r\nimport SpotifyWebApi from 'spotify-web-api-node'\r\nimport axios from \"axios\"\r\nimport {BASE_API_URL} from './Constants'\r\n\r\nconst spotifyApi = new SpotifyWebApi({\r\n    clientId: 'be9b18b908064fafa6daf43e1a490689',\r\n})\r\n\r\nexport default function Dashboard({ code }) {\r\n    const accessToken = useAuth(code)\r\n    const [search, setSearch] = useState(\"\")\r\n    const [searchResults, setSearchResults] = useState([])\r\n    const [playingTrack, setPlayingTrack] = useState()\r\n    const [lyrics, setLyrics] = useState(\"\")\r\n\r\n    function chooseTrack(track) {\r\n        setPlayingTrack(track)\r\n        setSearch('')\r\n        setLyrics(\"\")\r\n    }\r\n\r\n    useEffect(() => {\r\n        if(!playingTrack) return\r\n\r\n        axios.get(`${BASE_API_URL}/lyrics`, {\r\n            params: {\r\n                track: playingTrack.title,\r\n                artist: playingTrack.artist\r\n            }\r\n        }).then(res => {\r\n            setLyrics(res.data.lyrics)\r\n        })\r\n    }, [playingTrack])\r\n\r\n    useEffect(() => {\r\n        if(!accessToken) return\r\n        spotifyApi.setAccessToken(accessToken)\r\n    }, [accessToken])\r\n\r\n    useEffect(() => {\r\n        if(!search) return setSearchResults([])\r\n        if(!accessToken) return\r\n\r\n        let cancel = false\r\n        spotifyApi.searchTracks(search).then(res => {\r\n            if(cancel) return\r\n            setSearchResults(res.body.tracks.items.map(track => {\r\n                const smallestAlbumImage = track.album.images.reduce(\r\n                    (smallest, image) => {\r\n                        if(image.height < smallest.height) return image\r\n                        return smallest\r\n                    }, \r\n                    track.album.images[0]\r\n                )\r\n                return {\r\n                    artist: track.artists[0].name,\r\n                    title: track.name,\r\n                    uri: track.uri,\r\n                    albumUrl: smallestAlbumImage.url,\r\n                }\r\n            }))\r\n        })\r\n\r\n        return () => cancel = true\r\n    }, [search, accessToken])\r\n\r\n    return (\r\n        <Container className=\"d-flex flex-column py-2\" style={{height: \"100vh\"}}>\r\n            <Form.Control type=\"search\" placeholder=\"Search Songs/Artists\" value={search} onChange={e => setSearch(e.target.value)} />\r\n            <div className=\"flex-grow-1 my-2\" style={{overflowY:\"auto\"}}>\r\n                {searchResults.map(track => (\r\n                <TrackSearchResult track={track} key={track.uri} chooseTrack={chooseTrack} />\r\n            ))}\r\n            {searchResults.length === 0 && (\r\n                <div className=\"text-center\" style={{whiteSpace: \"pre\"}}>\r\n                    {lyrics}\r\n                    </div>\r\n            )}\r\n            </div>\r\n            <div>\r\n                <Player accessToken={accessToken} trackUri={playingTrack?.uri}/></div>\r\n        </Container>\r\n    )\r\n}\r\n","import {useState, useEffect} from 'react'\r\nimport axios from 'axios'\r\nimport {BASE_API_URL} from './Constants'\r\n\r\nexport default function useAuth(code) {\r\n    const [accessToken, setAccessToken] = useState()\r\n    const [refreshToken, setRefreshToken] = useState()\r\n    const [expiresIn, setExpiresIn] = useState()\r\n\r\n    useEffect(() => {\r\n        axios.post(`${BASE_API_URL}/login`, {\r\n            code,\r\n        }).then(res => {\r\n            setAccessToken(res.data.accessToken)\r\n            setRefreshToken(res.data.refreshToken)\r\n            setExpiresIn(res.data.expiresIn)\r\n            window.history.pushState({}, null, \"/\")\r\n        }).catch(() => {\r\n            window.location = '/'\r\n        })\r\n    }, [code])\r\n\r\n    useEffect(() => {\r\n        if(!refreshToken || !expiresIn) return\r\n        const interval = setInterval(() => {\r\n            axios.post(`${BASE_API_URL}/refresh`, {\r\n                refreshToken,\r\n            }).then(res => {\r\n                setAccessToken(res.data.accessToken)\r\n                setExpiresIn(res.data.expiresIn)\r\n            }).catch(() => {\r\n                window.location = '/'\r\n            })\r\n        }, (expiresIn - 60) * 1000)\r\n\r\n        return () => clearInterval(interval)\r\n    }, [refreshToken, expiresIn])\r\n\r\n    return accessToken\r\n}\r\n","import 'bootstrap/dist/css/bootstrap.min.css'\nimport Login from './Login'\nimport Dashboard from './Dashboard'\n\nconst code = new URLSearchParams(window.location.search).get('code')\n\n\nfunction App() {\n  return code ? <Dashboard code={code} /> : <Login />\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}